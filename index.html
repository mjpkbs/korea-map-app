<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Korean Administrative Map</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üó∫Ô∏è</text></svg>">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
            display: flex;
        }

        #map {
            flex: 1;
            height: 100vh;
        }

        .controls {
            width: 350px;
            background: #fff;
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            overflow-y: auto;
            height: 100vh;
        }

        .control-group {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .control-group:last-child {
            border-bottom: none;
        }

        .control-group h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 16px;
            font-weight: 600;
        }

        .control-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
        }

        .control-item label {
            min-width: 80px;
            font-size: 14px;
            color: #666;
        }

        input[type="color"] {
            width: 40px;
            height: 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        input[type="range"] {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
        }

        input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .admin-section {
            margin-bottom: 20px;
        }

        .admin-section h4 {
            margin-bottom: 10px;
            color: #444;
            font-size: 14px;
            font-weight: 500;
        }

        .selection-area {
            display: flex;
            gap: 8px;
            margin-bottom: 10px;
            position: relative;
        }

        .autocomplete-container {
            position: relative;
            flex: 1;
        }

        .autocomplete-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 4px 4px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .autocomplete-suggestion {
            padding: 8px 12px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14px;
        }

        .autocomplete-suggestion:hover {
            background-color: #f5f5f5;
        }

        .autocomplete-suggestion.highlighted {
            background-color: #007cbf;
            color: white;
        }

        .autocomplete-suggestion:last-child {
            border-bottom: none;
        }

        input[type="text"] {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .add-btn {
            padding: 8px 12px;
            background: #007cbf;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .add-btn:hover {
            background: #005a8f;
        }

        .selected-items {
            max-height: 120px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 4px;
            padding: 8px;
            background: #f9f9f9;
        }

        .selected-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 4px 8px;
            margin-bottom: 4px;
            background: white;
            border-radius: 3px;
            border: 1px solid #ddd;
            font-size: 13px;
        }

        .selected-item span {
            flex: 1;
            margin-right: 8px;
        }

        .selected-item input[type="color"] {
            width: 25px;
            height: 25px;
            margin-right: 5px;
        }

        .remove-btn {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 3px;
            padding: 2px 6px;
            cursor: pointer;
            font-size: 11px;
        }

        .remove-btn:hover {
            background: #c82333;
        }

        datalist {
            max-height: 200px;
        }

        .width-display {
            margin-left: 10px;
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="controls">
        <h2 style="margin-bottom: 25px; color: #333;">Korean Administrative Map</h2>
        
        <!-- Map Style Controls -->
        <div class="control-group">
            <h3>Map Style</h3>
            <div class="control-item">
                <label>Ocean:</label>
                <input type="color" id="oceanColor" value="#a6cee3">
            </div>
            <div class="control-item">
                <label>Land:</label>
                <input type="color" id="landColor" value="#f0f0f0">
            </div>
        </div>

        <!-- Boundary Controls -->
        <div class="control-group">
            <h3>Boundaries</h3>
            
            <!-- ÏãúÎèÑ Boundaries (always visible) -->
            <div class="admin-section">
                <h4>ÏãúÎèÑ Boundaries</h4>
                <div class="control-item">
                    <label>Color:</label>
                    <input type="color" id="sidoBoundaryColor" value="#333333">
                </div>
                <div class="control-item">
                    <label>Width:</label>
                    <input type="range" id="sidoBoundaryWidth" min="0.5" max="5" step="0.5" value="2">
                    <span class="width-display" id="sidoWidthDisplay">2px</span>
                </div>
                <div class="control-item">
                    <label>Dashed:</label>
                    <input type="checkbox" id="sidoDashedBoundary">
                </div>
            </div>

            <!-- ÏãúÍµ∞Íµ¨ Boundaries -->
            <div class="admin-section">
                <h4>ÏãúÍµ∞Íµ¨ Boundaries</h4>
                <div class="control-item">
                    <label>Show:</label>
                    <input type="checkbox" id="showSigunguBoundary">
                </div>
                <div class="control-item">
                    <label>Color:</label>
                    <input type="color" id="sigunguBoundaryColor" value="#666666">
                </div>
                <div class="control-item">
                    <label>Width:</label>
                    <input type="range" id="sigunguBoundaryWidth" min="0.5" max="5" step="0.5" value="1">
                    <span class="width-display" id="sigunguWidthDisplay">1px</span>
                </div>
                <div class="control-item">
                    <label>Dashed:</label>
                    <input type="checkbox" id="sigunguDashedBoundary">
                </div>
            </div>

            <!-- ÏùçÎ©¥Îèô Boundaries -->
            <div class="admin-section">
                <h4>ÏùçÎ©¥Îèô Boundaries</h4>
                <div class="control-item">
                    <label>Show:</label>
                    <input type="checkbox" id="showEubmyeondongBoundary">
                </div>
                <div class="control-item">
                    <label>Color:</label>
                    <input type="color" id="eubmyeondongBoundaryColor" value="#999999">
                </div>
                <div class="control-item">
                    <label>Width:</label>
                    <input type="range" id="eubmyeondongBoundaryWidth" min="0.5" max="5" step="0.5" value="0.5">
                    <span class="width-display" id="eubmyeondongWidthDisplay">0.5px</span>
                </div>
                <div class="control-item">
                    <label>Dashed:</label>
                    <input type="checkbox" id="eubmyeondongDashedBoundary">
                </div>
            </div>
        </div>

        <!-- Administrative Divisions -->
        <div class="control-group">
            <h3>Administrative Divisions</h3>
            
            <!-- ÏãúÎèÑ Section -->
            <div class="admin-section">
                <h4>ÏãúÎèÑ (Provinces)</h4>
                <div class="selection-area">
                    <input type="text" id="sidoInput" list="sidoList" placeholder="Select ÏãúÎèÑ...">
                    <input type="color" id="sidoColor" value="#ff6b6b">
                    <button class="add-btn" onclick="addSelection('sido')">Add</button>
                </div>
                <datalist id="sidoList"></datalist>
                <div class="selected-items" id="sidoSelected"></div>
            </div>

            <!-- ÏãúÍµ∞Íµ¨ Section -->
            <div class="admin-section">
                <h4>ÏãúÍµ∞Íµ¨ (Cities/Counties)</h4>
                <div class="selection-area">
                    <div class="autocomplete-container">
                        <input type="text" id="sigunguInput" placeholder="Type ÏãúÍµ∞Íµ¨ name..." autocomplete="off">
                        <div class="autocomplete-suggestions" id="sigunguSuggestions"></div>
                    </div>
                    <input type="color" id="sigunguColor" value="#4ecdc4">
                    <button class="add-btn" onclick="addSelection('sigungu')">Add</button>
                </div>
                <div class="selected-items" id="sigunguSelected"></div>
            </div>

            <!-- ÏùçÎ©¥Îèô Section -->
            <div class="admin-section">
                <h4>ÏùçÎ©¥Îèô (Towns/Neighborhoods)</h4>
                <div class="selection-area">
                    <div class="autocomplete-container">
                        <input type="text" id="eubmyeondongInput" placeholder="Type ÏùçÎ©¥Îèô name..." autocomplete="off">
                        <div class="autocomplete-suggestions" id="eubmyeondongSuggestions"></div>
                    </div>
                    <input type="color" id="eubmyeondongColor" value="#45b7d1">
                    <button class="add-btn" onclick="addSelection('eubmyeondong')">Add</button>
                </div>
                <div class="selected-items" id="eubmyeondongSelected"></div>
            </div>
        </div>
    </div>

    <div id="map"></div>

    <script>
        // Initialize Mapbox
        mapboxgl.accessToken = 'pk.eyJ1IjoibW1qanBwIiwiYSI6ImNtZmZnM3RwODBoYnEya3B6bnB3NW5zcHQifQ.6UON_8x8X84bxsCrURuggA';

        const map = new mapboxgl.Map({
            container: 'map',
            style: {
                version: 8,
                sources: {
                    'mapbox-streets': {
                        type: 'vector',
                        url: 'mapbox://mapbox.mapbox-streets-v8'
                    }
                },
                layers: [
                    {
                        id: 'background',
                        type: 'background',
                        paint: {
                            'background-color': '#a6cee3'
                        }
                    },
                    {
                        id: 'land',
                        type: 'fill',
                        source: 'mapbox-streets',
                        'source-layer': 'country_boundaries',
                        paint: {
                            'fill-color': '#f0f0f0'
                        }
                    }
                ]
            },
            center: [127.7669, 35.9078],
            zoom: 6
        });

        // Administrative data storage
        const adminData = {
            sido: { 
                tileset: 'mmjjpp.25rm7fx4',
                field: 'SIDO_NM',
                names: [],
                selected: new Map()
            },
            sigungu: { 
                tileset: 'mmjjpp.b4x5ixng',
                field: 'SIGUNGU_NM',
                names: [],
                selected: new Map()
            },
            eubmyeondong: { 
                tileset: 'mmjjpp.53755csu',
                field: 'ADM_NM',
                names: [],
                selected: new Map()
            }
        };

        // Initialize map
        map.on('load', () => {
            // Add sources
            map.addSource('sido-source', {
                type: 'vector',
                url: `mapbox://${adminData.sido.tileset}`
            });

            map.addSource('sigungu-source', {
                type: 'vector',
                url: `mapbox://${adminData.sigungu.tileset}`
            });

            map.addSource('eubmyeondong-source', {
                type: 'vector',
                url: `mapbox://${adminData.eubmyeondong.tileset}`
            });

            // Add boundary layers
            addBoundaryLayers();

            // Add fill layers for selected regions
            addFillLayers();

            // Load administrative names
            loadAdminNames();

            // Initialize map style with current color values
            updateMapStyle();
        });

        function addBoundaryLayers() {
            // ÏãúÎèÑ boundaries (always visible)
            map.addLayer({
                id: 'sido-boundaries',
                type: 'line',
                source: 'sido-source',
                'source-layer': 'BND_SIDO_PG-b2cuck',
                paint: {
                    'line-color': '#333333',
                    'line-width': 2,
                    'line-dasharray': [1, 0]
                }
            });

            // ÏãúÍµ∞Íµ¨ boundaries (initially hidden)
            map.addLayer({
                id: 'sigungu-boundaries',
                type: 'line',
                source: 'sigungu-source',
                'source-layer': 'BND_SIGUNGU_PG-8djgqa',
                layout: {
                    'visibility': 'none'
                },
                paint: {
                    'line-color': '#666666',
                    'line-width': 1,
                    'line-dasharray': [1, 0]
                }
            });

            // ÏùçÎ©¥Îèô boundaries (initially hidden)
            map.addLayer({
                id: 'eubmyeondong-boundaries',
                type: 'line',
                source: 'eubmyeondong-source',
                'source-layer': 'BND_ADM_DONG_PG-3p138h',
                layout: {
                    'visibility': 'none'
                },
                paint: {
                    'line-color': '#999999',
                    'line-width': 0.5,
                    'line-dasharray': [1, 0]
                }
            });
        }

        function addFillLayers() {
            // ÏãúÎèÑ fills
            map.addLayer({
                id: 'sido-fill',
                type: 'fill',
                source: 'sido-source',
                'source-layer': 'BND_SIDO_PG-b2cuck',
                paint: {
                    'fill-color': [
                        'case',
                        ['has', ['get', 'SIDO_NM'], ['literal', {}]],
                        ['get', ['get', 'SIDO_NM'], ['literal', {}]],
                        'rgba(0,0,0,0)'
                    ],
                    'fill-opacity': 0.7
                }
            }, 'sido-boundaries');

            // ÏãúÍµ∞Íµ¨ fills
            map.addLayer({
                id: 'sigungu-fill',
                type: 'fill',
                source: 'sigungu-source',
                'source-layer': 'BND_SIGUNGU_PG-8djgqa',
                paint: {
                    'fill-color': [
                        'case',
                        ['has', ['get', 'SIGUNGU_NM'], ['literal', {}]],
                        ['get', ['get', 'SIGUNGU_NM'], ['literal', {}]],
                        'rgba(0,0,0,0)'
                    ],
                    'fill-opacity': 0.7
                }
            }, 'sigungu-boundaries');

            // ÏùçÎ©¥Îèô fills
            map.addLayer({
                id: 'eubmyeondong-fill',
                type: 'fill',
                source: 'eubmyeondong-source',
                'source-layer': 'BND_ADM_DONG_PG-3p138h',
                paint: {
                    'fill-color': [
                        'case',
                        ['has', ['get', 'ADM_NM'], ['literal', {}]],
                        ['get', ['get', 'ADM_NM'], ['literal', {}]],
                        'rgba(0,0,0,0)'
                    ],
                    'fill-opacity': 0.7
                }
            }, 'eubmyeondong-boundaries');
        }

        async function loadAdminNames() {
            // Complete ÏãúÎèÑ list
            adminData.sido.names = [
                'ÏÑúÏö∏ÌäπÎ≥ÑÏãú', 'Î∂ÄÏÇ∞Í¥ëÏó≠Ïãú', 'ÎåÄÍµ¨Í¥ëÏó≠Ïãú', 'Ïù∏Ï≤úÍ¥ëÏó≠Ïãú', 'Í¥ëÏ£ºÍ¥ëÏó≠Ïãú',
                'ÎåÄÏ†ÑÍ¥ëÏó≠Ïãú', 'Ïö∏ÏÇ∞Í¥ëÏó≠Ïãú', 'ÏÑ∏Ï¢ÖÌäπÎ≥ÑÏûêÏπòÏãú', 'Í≤ΩÍ∏∞ÎèÑ', 'Í∞ïÏõêÎèÑ',
                'Ï∂©Ï≤≠Î∂ÅÎèÑ', 'Ï∂©Ï≤≠ÎÇ®ÎèÑ', 'Ï†ÑÎùºÎ∂ÅÎèÑ', 'Ï†ÑÎùºÎÇ®ÎèÑ', 'Í≤ΩÏÉÅÎ∂ÅÎèÑ', 'Í≤ΩÏÉÅÎÇ®ÎèÑ', 'Ï†úÏ£ºÌäπÎ≥ÑÏûêÏπòÎèÑ'
            ];

            // Comprehensive ÏãúÍµ∞Íµ¨ list
            adminData.sigungu.names = [
                // ÏÑúÏö∏ 25Í∞ú Íµ¨
                'Ï¢ÖÎ°úÍµ¨', 'Ï§ëÍµ¨', 'Ïö©ÏÇ∞Íµ¨', 'ÏÑ±ÎèôÍµ¨', 'Í¥ëÏßÑÍµ¨', 'ÎèôÎåÄÎ¨∏Íµ¨', 'Ï§ëÎûëÍµ¨', 'ÏÑ±Î∂ÅÍµ¨', 'Í∞ïÎ∂ÅÍµ¨', 'ÎèÑÎ¥âÍµ¨',
                'ÎÖ∏ÏõêÍµ¨', 'ÏùÄÌèâÍµ¨', 'ÏÑúÎåÄÎ¨∏Íµ¨', 'ÎßàÌè¨Íµ¨', 'ÏñëÏ≤úÍµ¨', 'Í∞ïÏÑúÍµ¨', 'Íµ¨Î°úÍµ¨', 'Í∏àÏ≤úÍµ¨', 'ÏòÅÎì±Ìè¨Íµ¨', 'ÎèôÏûëÍµ¨',
                'Í¥ÄÏïÖÍµ¨', 'ÏÑúÏ¥àÍµ¨', 'Í∞ïÎÇ®Íµ¨', 'ÏÜ°ÌååÍµ¨', 'Í∞ïÎèôÍµ¨',
                // Î∂ÄÏÇ∞ 16Í∞ú Íµ¨/Íµ∞
                'Ï§ëÍµ¨', 'ÏÑúÍµ¨', 'ÎèôÍµ¨', 'ÏòÅÎèÑÍµ¨', 'Î∂ÄÏÇ∞ÏßÑÍµ¨', 'ÎèôÎûòÍµ¨', 'ÎÇ®Íµ¨', 'Î∂ÅÍµ¨', 'Ìï¥Ïö¥ÎåÄÍµ¨', 'ÏÇ¨ÌïòÍµ¨',
                'Í∏àÏ†ïÍµ¨', 'Í∞ïÏÑúÍµ¨', 'Ïó∞Ï†úÍµ¨', 'ÏàòÏòÅÍµ¨', 'ÏÇ¨ÏÉÅÍµ¨', 'Í∏∞Ïû•Íµ∞',
                // ÎåÄÍµ¨ 8Í∞ú Íµ¨/Íµ∞
                'Ï§ëÍµ¨', 'ÎèôÍµ¨', 'ÏÑúÍµ¨', 'ÎÇ®Íµ¨', 'Î∂ÅÍµ¨', 'ÏàòÏÑ±Íµ¨', 'Îã¨ÏÑúÍµ¨', 'Îã¨ÏÑ±Íµ∞',
                // Ïù∏Ï≤ú 10Í∞ú Íµ¨/Íµ∞
                'Ï§ëÍµ¨', 'ÎèôÍµ¨', 'ÎØ∏Ï∂îÌôÄÍµ¨', 'Ïó∞ÏàòÍµ¨', 'ÎÇ®ÎèôÍµ¨', 'Î∂ÄÌèâÍµ¨', 'Í≥ÑÏñëÍµ¨', 'ÏÑúÍµ¨', 'Í∞ïÌôîÍµ∞', 'ÏòπÏßÑÍµ∞',
                // Í¥ëÏ£º 5Í∞ú Íµ¨
                'ÎèôÍµ¨', 'ÏÑúÍµ¨', 'ÎÇ®Íµ¨', 'Î∂ÅÍµ¨', 'Í¥ëÏÇ∞Íµ¨',
                // ÎåÄÏ†Ñ 5Í∞ú Íµ¨
                'ÎèôÍµ¨', 'Ï§ëÍµ¨', 'ÏÑúÍµ¨', 'Ïú†ÏÑ±Íµ¨', 'ÎåÄÎçïÍµ¨',
                // Ïö∏ÏÇ∞ 5Í∞ú Íµ¨/Íµ∞
                'Ï§ëÍµ¨', 'ÎÇ®Íµ¨', 'ÎèôÍµ¨', 'Î∂ÅÍµ¨', 'Ïö∏Ï£ºÍµ∞',
                // ÏÑ∏Ï¢ÖÌäπÎ≥ÑÏûêÏπòÏãú
                'ÏÑ∏Ï¢ÖÌäπÎ≥ÑÏûêÏπòÏãú',
                // Í≤ΩÍ∏∞ÎèÑ Ï£ºÏöî Ïãú/Íµ∞
                'ÏàòÏõêÏãú', 'ÏÑ±ÎÇ®Ïãú', 'Í≥†ÏñëÏãú', 'Ïö©Ïù∏Ïãú', 'Î∂ÄÏ≤úÏãú', 'ÏïàÏÇ∞Ïãú', 'ÏïàÏñëÏãú', 'ÎÇ®ÏñëÏ£ºÏãú', 'ÌôîÏÑ±Ïãú', 'ÌèâÌÉùÏãú',
                'ÏùòÏ†ïÎ∂ÄÏãú', 'ÏãúÌù•Ïãú', 'ÌååÏ£ºÏãú', 'Í¥ëÎ™ÖÏãú', 'ÍπÄÌè¨Ïãú', 'Íµ∞Ìè¨Ïãú', 'Í¥ëÏ£ºÏãú', 'Ïù¥Ï≤úÏãú', 'ÏñëÏ£ºÏãú', 'Ïò§ÏÇ∞Ïãú',
                'Íµ¨Î¶¨Ïãú', 'ÏïàÏÑ±Ïãú', 'Ìè¨Ï≤úÏãú', 'ÏùòÏôïÏãú', 'ÌïòÎÇ®Ïãú', 'Ïó¨Ï£ºÏãú', 'ÎèôÎëêÏ≤úÏãú', 'Í≥ºÏ≤úÏãú', 'Í∞ÄÌèâÍµ∞', 'ÏñëÌèâÍµ∞', 'Ïó∞Ï≤úÍµ∞',
                // Í∞ïÏõêÎèÑ Ï£ºÏöî Ïãú/Íµ∞
                'Ï∂òÏ≤úÏãú', 'ÏõêÏ£ºÏãú', 'Í∞ïÎ¶âÏãú', 'ÎèôÌï¥Ïãú', 'ÌÉúÎ∞±Ïãú', 'ÏÜçÏ¥àÏãú', 'ÏÇºÏ≤ôÏãú', 'ÌôçÏ≤úÍµ∞', 'Ìö°ÏÑ±Íµ∞', 'ÏòÅÏõîÍµ∞',
                'ÌèâÏ∞ΩÍµ∞', 'Ï†ïÏÑ†Íµ∞', 'Ï≤†ÏõêÍµ∞', 'ÌôîÏ≤úÍµ∞', 'ÏñëÍµ¨Íµ∞', 'Ïù∏Ï†úÍµ∞', 'Í≥†ÏÑ±Íµ∞', 'ÏñëÏñëÍµ∞',
                // Ï∂©Ï≤≠Î∂ÅÎèÑ Ï£ºÏöî Ïãú/Íµ∞
                'Ï≤≠Ï£ºÏãú', 'Ï∂©Ï£ºÏãú', 'Ï†úÏ≤úÏãú', 'Î≥¥ÏùÄÍµ∞', 'Ïò•Ï≤úÍµ∞', 'ÏòÅÎèôÍµ∞', 'Ï¶ùÌèâÍµ∞', 'ÏßÑÏ≤úÍµ∞', 'Í¥¥ÏÇ∞Íµ∞', 'ÏùåÏÑ±Íµ∞', 'Îã®ÏñëÍµ∞',
                // Ï∂©Ï≤≠ÎÇ®ÎèÑ Ï£ºÏöî Ïãú/Íµ∞
                'Ï≤úÏïàÏãú', 'Í≥µÏ£ºÏãú', 'Î≥¥Î†πÏãú', 'ÏïÑÏÇ∞Ïãú', 'ÏÑúÏÇ∞Ïãú', 'ÎÖºÏÇ∞Ïãú', 'Í≥ÑÎ£°Ïãú', 'ÎãπÏßÑÏãú', 'Í∏àÏÇ∞Íµ∞', 'Î∂ÄÏó¨Íµ∞',
                'ÏÑúÏ≤úÍµ∞', 'Ï≤≠ÏñëÍµ∞', 'ÌôçÏÑ±Íµ∞', 'ÏòàÏÇ∞Íµ∞', 'ÌÉúÏïàÍµ∞',
                // Ï†ÑÎùºÎ∂ÅÎèÑ Ï£ºÏöî Ïãú/Íµ∞
                'Ï†ÑÏ£ºÏãú', 'Íµ∞ÏÇ∞Ïãú', 'ÏùµÏÇ∞Ïãú', 'Ï†ïÏùçÏãú', 'ÎÇ®ÏõêÏãú', 'ÍπÄÏ†úÏãú', 'ÏôÑÏ£ºÍµ∞', 'ÏßÑÏïàÍµ∞', 'Î¨¥Ï£ºÍµ∞', 'Ïû•ÏàòÍµ∞',
                'ÏûÑÏã§Íµ∞', 'ÏàúÏ∞ΩÍµ∞', 'Í≥†Ï∞ΩÍµ∞', 'Î∂ÄÏïàÍµ∞',
                // Ï†ÑÎùºÎÇ®ÎèÑ Ï£ºÏöî Ïãú/Íµ∞
                'Î™©Ìè¨Ïãú', 'Ïó¨ÏàòÏãú', 'ÏàúÏ≤úÏãú', 'ÎÇòÏ£ºÏãú', 'Í¥ëÏñëÏãú', 'Îã¥ÏñëÍµ∞', 'Í≥°ÏÑ±Íµ∞', 'Íµ¨Î°ÄÍµ∞', 'Í≥†Ìù•Íµ∞', 'Î≥¥ÏÑ±Íµ∞',
                'ÌôîÏàúÍµ∞', 'Ïû•Ìù•Íµ∞', 'Í∞ïÏßÑÍµ∞', 'Ìï¥ÎÇ®Íµ∞', 'ÏòÅÏïîÍµ∞', 'Î¨¥ÏïàÍµ∞', 'Ìï®ÌèâÍµ∞', 'ÏòÅÍ¥ëÍµ∞', 'Ïû•ÏÑ±Íµ∞', 'ÏôÑÎèÑÍµ∞',
                'ÏßÑÎèÑÍµ∞', 'Ïã†ÏïàÍµ∞',
                // Í≤ΩÏÉÅÎ∂ÅÎèÑ Ï£ºÏöî Ïãú/Íµ∞
                'Ìè¨Ìï≠Ïãú', 'Í≤ΩÏ£ºÏãú', 'ÍπÄÏ≤úÏãú', 'ÏïàÎèôÏãú', 'Íµ¨ÎØ∏Ïãú', 'ÏòÅÏ£ºÏãú', 'ÏòÅÏ≤úÏãú', 'ÏÉÅÏ£ºÏãú', 'Î¨∏Í≤ΩÏãú', 'Í≤ΩÏÇ∞Ïãú',
                'Íµ∞ÏúÑÍµ∞', 'ÏùòÏÑ±Íµ∞', 'Ï≤≠ÏÜ°Íµ∞', 'ÏòÅÏñëÍµ∞', 'ÏòÅÎçïÍµ∞', 'Ï≤≠ÎèÑÍµ∞', 'Í≥†Î†πÍµ∞', 'ÏÑ±Ï£ºÍµ∞', 'Ïπ†Í≥°Íµ∞', 'ÏòàÏ≤úÍµ∞',
                'Î¥âÌôîÍµ∞', 'Ïö∏ÏßÑÍµ∞', 'Ïö∏Î¶âÍµ∞',
                // Í≤ΩÏÉÅÎÇ®ÎèÑ Ï£ºÏöî Ïãú/Íµ∞
                'Ï∞ΩÏõêÏãú', 'ÏßÑÏ£ºÏãú', 'ÌÜµÏòÅÏãú', 'ÏÇ¨Ï≤úÏãú', 'ÍπÄÌï¥Ïãú', 'Î∞ÄÏñëÏãú', 'Í±∞Ï†úÏãú', 'ÏñëÏÇ∞Ïãú', 'ÏùòÎ†πÍµ∞', 'Ìï®ÏïàÍµ∞',
                'Ï∞ΩÎÖïÍµ∞', 'Í≥†ÏÑ±Íµ∞', 'ÎÇ®Ìï¥Íµ∞', 'ÌïòÎèôÍµ∞', 'ÏÇ∞Ï≤≠Íµ∞', 'Ìï®ÏñëÍµ∞', 'Í±∞Ï∞ΩÍµ∞', 'Ìï©Ï≤úÍµ∞',
                // Ï†úÏ£ºÌäπÎ≥ÑÏûêÏπòÎèÑ
                'Ï†úÏ£ºÏãú', 'ÏÑúÍ∑ÄÌè¨Ïãú'
            ];

            // Comprehensive ÏùçÎ©¥Îèô list (sample - would need full list from actual data)
            adminData.eubmyeondong.names = [
                // ÏÑúÏö∏ Ï£ºÏöî Îèô
                'Î™ÖÎèô', 'Ï∂©Î¨¥Î°ú', 'ÏùÑÏßÄÎ°úÎèô', 'Ïã†ÎãπÎèô', 'Îã§ÏÇ∞Îèô', 'ÏïΩÏàòÎèô', 'Ï≤≠Íµ¨Îèô', 'Ïã†ÎãπÎèô', 'Ìô©ÌïôÎèô', 'Ï§ëÎ¶ºÎèô',
                'ÌõÑÏïîÎèô', 'Ïö©ÏÇ∞Îèô', 'ÌïúÍ∞ïÎ°úÎèô', 'Ïù¥Ï¥åÎèô', 'ÌïúÎÇ®Îèô', 'ÏÑúÎπôÍ≥†Îèô', 'Î≥¥Í¥ëÎèô', 'Ï≤≠ÌååÎèô', 'ÏõêÌö®Î°úÎèô',
                'ÏôïÏã≠Î¶¨Îèô', 'ÎßàÏû•Îèô', 'ÏÇ¨Í∑ºÎèô', 'ÌñâÎãπÎèô', 'ÏùëÎ¥âÎèô', 'Í∏àÌò∏Îèô', 'Ïò•ÏàòÎèô', 'ÏÑ±ÏàòÎèô', 'ÏÜ°Ï†ïÎèô',
                'Ïö©ÎãµÎèô', 'Ï§ëÍ≥°Îèô', 'Îä•Îèô', 'Íµ¨ÏùòÎèô', 'Í¥ëÏû•Îèô', 'ÏûêÏñëÎèô', 'ÌôîÏñëÎèô', 'Íµ∞ÏûêÎèô', 'Ï§ëÌôîÎèô',
                'Ï†ÑÎÜçÎèô', 'ÎãµÏã≠Î¶¨Îèô', 'Ïû•ÏïàÎèô', 'Ï≤≠ÎüâÎ¶¨Îèô', 'ÌöåÍ∏∞Îèô', 'ÌúòÍ≤ΩÎèô', 'Ïù¥Î¨∏Îèô', 'Ïö©ÎëêÎèô', 'Ï†úÍ∏∞Îèô',
                'Ïã†ÏÑ§Îèô', 'Î©¥Î™©Îèô', 'ÏÉÅÎ¥âÎèô', 'Ï§ëÌôîÎèô', 'Î¨µÎèô', 'ÎßùÏö∞Îèô', 'Ïã†ÎÇ¥Îèô',
                'ÏÑ±Î∂ÅÎèô', 'ÏÇºÏÑ†Îèô', 'ÎèôÏÑ†Îèô', 'ÎèàÏïîÎèô', 'ÏïàÏïîÎèô', 'Î≥¥Î¨∏Îèô', 'Ï†ïÎ¶âÎèô', 'Í∏∏ÏùåÎèô', 'Ï¢ÖÏïîÎèô',
                'ÎØ∏ÏïÑÎèô', 'Î≤àÎèô', 'ÏàòÏú†Îèô', 'Ïö∞Ïù¥Îèô', 'ÏåçÎ¨∏Îèô', 'Î∞©ÌïôÎèô', 'ÎèÑÎ¥âÎèô', 'Ï∞ΩÎèô', 'ÏÉÅÍ≥ÑÎèô',
                'Ï§ëÍ≥ÑÎèô', 'ÌïòÍ≥ÑÎèô', 'Í≥µÎ¶âÎèô', 'ÏõîÍ≥ÑÎèô', 'ÎÖ∏ÏõêÎèô', 'ÏÉÅÏõîÍ≥°Îèô', 'Ï§ëÏõîÍ≥°Îèô', 'ÌïòÏõîÍ≥°Îèô',
                'ÏùëÏïîÎèô', 'Ïó≠Ï¥åÎèô', 'Î∂àÍ¥ëÎèô', 'Íµ¨ÏÇ∞Îèô', 'ÎåÄÏ°∞Îèô', 'ÏßÑÍ¥ÄÎèô', 'Ïã†ÏÇ¨Îèô', 'Ïó∞Ìù¨Îèô', 'ÌôçÏ†úÎèô',
                'ÌôçÏùÄÎèô', 'ÎÇ®Í∞ÄÏ¢åÎèô', 'Î∂ÅÍ∞ÄÏ¢åÎèô', 'Ï∂©ÌòÑÎèô', 'ÌòÑÏ†ÄÎèô', 'ÌôçÏßÄÎèô', 'Ïã†Ï¥åÎèô', 'Ïó∞ÎÇ®Îèô', 'ÏÑ±ÏÇ∞Îèô',
                'ÎßùÏõêÎèô', 'Ìï©Ï†ïÎèô', 'ÏÉÅÏïîÎèô', 'ÎßàÌè¨Îèô', 'Í≥µÎçïÎèô', 'ÏïÑÌòÑÎèô', 'Ïö©Í∞ïÎèô', 'ÌÜ†Ï†ïÎèô', 'Ïã†Ï†ïÎèô',
                'Î™©Îèô', 'Ïã†ÏõîÎèô', 'ÏóºÏ∞ΩÎèô', 'Îì±Ï¥åÎèô', 'ÌôîÍ≥°Îèô', 'Ïö∞Ïû•ÏÇ∞Îèô', 'Í∞ÄÏñëÎèô', 'Î∞úÏÇ∞Îèô', 'Í≥µÌï≠Îèô',
                'Î∞©ÌôîÎèô', 'Í∞úÌôîÎèô', 'Í≥ºÌï¥Îèô', 'Ïò§Í≥°Îèô', 'Ïò§Ïá†Îèô', 'Ïô∏Î∞úÏÇ∞Îèô', 'Îì±Ï¥åÎèô', 'ÌôîÍ≥°Îèô', 'Í∞ÄÏñëÎèô',
                // Î∂ÄÏÇ∞ Ï£ºÏöî Îèô
                'Ï§ëÏïôÎèô', 'ÎèôÍ¥ëÎèô', 'ÎåÄÏ≤≠Îèô', 'Î≥¥ÏàòÎèô', 'Î∂ÄÌèâÎèô', 'ÏÑúÎ©¥', 'Î∂ÄÏ†ÑÎèô', 'ÎãπÍ∞êÎèô', 'Í∞úÍ∏àÎèô', 'Ïó∞ÏÇ∞Îèô',
                'Í±∞Ï†úÎèô', 'Ïó∞ÏßÄÎèô', 'ÎßùÎØ∏Îèô', 'Î∞òÏó¨Îèô', 'Ïû¨ÏÜ°Îèô', 'ÏÑºÌÖÄÏãúÌã∞', 'Ïö∞Îèô', 'Ï§ëÎèô', 'Ï¢åÎèô', 'ÏÜ°Ï†ïÎèô',
                'Í∏∞Ïû•Ïùç', 'Ï†ïÍ¥ÄÏùç', 'ÏùºÍ¥ëÎ©¥', 'Ï≤†ÎßàÎ©¥', 'Ïû•ÏïàÏùç'
            ];

            // Populate ÏãúÎèÑ datalist
            populateDatalist('sidoList', adminData.sido.names);
            
            // Initialize autocomplete for ÏãúÍµ∞Íµ¨ and ÏùçÎ©¥Îèô
            initializeAutocomplete('sigungu');
            initializeAutocomplete('eubmyeondong');
        }

        function populateDatalist(listId, names) {
            const datalist = document.getElementById(listId);
            datalist.innerHTML = '';
            names.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                datalist.appendChild(option);
            });
        }

        // Autocomplete functionality
        function initializeAutocomplete(type) {
            const input = document.getElementById(`${type}Input`);
            const suggestionsDiv = document.getElementById(`${type}Suggestions`);
            let currentHighlight = -1;
            
            input.addEventListener('input', function() {
                const value = this.value.toLowerCase();
                const suggestions = adminData[type].names.filter(name => 
                    name.toLowerCase().includes(value)
                ).slice(0, 10); // Limit to 10 suggestions
                
                showSuggestions(suggestions, suggestionsDiv, input, type);
                currentHighlight = -1;
            });
            
            input.addEventListener('keydown', function(e) {
                const suggestions = suggestionsDiv.querySelectorAll('.autocomplete-suggestion');
                
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    currentHighlight = Math.min(currentHighlight + 1, suggestions.length - 1);
                    updateHighlight(suggestions, currentHighlight);
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    currentHighlight = Math.max(currentHighlight - 1, -1);
                    updateHighlight(suggestions, currentHighlight);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    if (currentHighlight >= 0 && suggestions[currentHighlight]) {
                        selectSuggestion(suggestions[currentHighlight].textContent, input, suggestionsDiv);
                    } else if (this.value.trim()) {
                        selectSuggestion(this.value.trim(), input, suggestionsDiv);
                    }
                } else if (e.key === 'Escape') {
                    hideSuggestions(suggestionsDiv);
                    currentHighlight = -1;
                }
            });
            
            input.addEventListener('blur', function() {
                // Delay hiding to allow for clicks on suggestions
                setTimeout(() => hideSuggestions(suggestionsDiv), 150);
            });
            
            input.addEventListener('focus', function() {
                if (this.value) {
                    const value = this.value.toLowerCase();
                    const suggestions = adminData[type].names.filter(name => 
                        name.toLowerCase().includes(value)
                    ).slice(0, 10);
                    showSuggestions(suggestions, suggestionsDiv, input, type);
                }
            });
        }
        
        function showSuggestions(suggestions, suggestionsDiv, input, type) {
            suggestionsDiv.innerHTML = '';
            
            if (suggestions.length === 0 || !input.value.trim()) {
                suggestionsDiv.style.display = 'none';
                return;
            }
            
            suggestions.forEach(suggestion => {
                const div = document.createElement('div');
                div.className = 'autocomplete-suggestion';
                div.textContent = suggestion;
                div.addEventListener('click', function() {
                    selectSuggestion(suggestion, input, suggestionsDiv);
                });
                suggestionsDiv.appendChild(div);
            });
            
            suggestionsDiv.style.display = 'block';
        }
        
        function hideSuggestions(suggestionsDiv) {
            suggestionsDiv.style.display = 'none';
        }
        
        function updateHighlight(suggestions, highlightIndex) {
            suggestions.forEach((suggestion, index) => {
                suggestion.classList.toggle('highlighted', index === highlightIndex);
            });
        }
        
        function selectSuggestion(value, input, suggestionsDiv) {
            input.value = value;
            hideSuggestions(suggestionsDiv);
            input.focus();
        }

        // Control event listeners
        document.getElementById('oceanColor').addEventListener('change', updateMapStyle);
        document.getElementById('landColor').addEventListener('change', updateMapStyle);

        // ÏãúÎèÑ boundary controls
        document.getElementById('sidoBoundaryColor').addEventListener('change', () => updateBoundaryStyle('sido'));
        document.getElementById('sidoBoundaryWidth').addEventListener('input', () => updateBoundaryStyle('sido'));
        document.getElementById('sidoDashedBoundary').addEventListener('change', () => updateBoundaryStyle('sido'));

        // ÏãúÍµ∞Íµ¨ boundary controls
        document.getElementById('showSigunguBoundary').addEventListener('change', toggleBoundaryVisibility);
        document.getElementById('sigunguBoundaryColor').addEventListener('change', () => updateBoundaryStyle('sigungu'));
        document.getElementById('sigunguBoundaryWidth').addEventListener('input', () => updateBoundaryStyle('sigungu'));
        document.getElementById('sigunguDashedBoundary').addEventListener('change', () => updateBoundaryStyle('sigungu'));

        // ÏùçÎ©¥Îèô boundary controls
        document.getElementById('showEubmyeondongBoundary').addEventListener('change', toggleBoundaryVisibility);
        document.getElementById('eubmyeondongBoundaryColor').addEventListener('change', () => updateBoundaryStyle('eubmyeondong'));
        document.getElementById('eubmyeondongBoundaryWidth').addEventListener('input', () => updateBoundaryStyle('eubmyeondong'));
        document.getElementById('eubmyeondongDashedBoundary').addEventListener('change', () => updateBoundaryStyle('eubmyeondong'));

        // Width display updates
        document.getElementById('sidoBoundaryWidth').addEventListener('input', (e) => {
            document.getElementById('sidoWidthDisplay').textContent = e.target.value + 'px';
        });
        document.getElementById('sigunguBoundaryWidth').addEventListener('input', (e) => {
            document.getElementById('sigunguWidthDisplay').textContent = e.target.value + 'px';
        });
        document.getElementById('eubmyeondongBoundaryWidth').addEventListener('input', (e) => {
            document.getElementById('eubmyeondongWidthDisplay').textContent = e.target.value + 'px';
        });

        function updateMapStyle() {
            const oceanColor = document.getElementById('oceanColor').value;
            const landColor = document.getElementById('landColor').value;
            
            // Update ocean/background color
            map.setPaintProperty('background', 'background-color', oceanColor);
            
            // Update land color
            if (map.getLayer('land')) {
                map.setPaintProperty('land', 'fill-color', landColor);
            }
        }

        function updateBoundaryStyle(type) {
            const boundaryColor = document.getElementById(`${type}BoundaryColor`).value;
            const boundaryWidth = parseFloat(document.getElementById(`${type}BoundaryWidth`).value);
            const isDashed = document.getElementById(`${type}DashedBoundary`).checked;
            
            const dashArray = isDashed ? [2, 2] : [1, 0];
            const layerId = `${type}-boundaries`;
            
            map.setPaintProperty(layerId, 'line-color', boundaryColor);
            map.setPaintProperty(layerId, 'line-width', boundaryWidth);
            map.setPaintProperty(layerId, 'line-dasharray', dashArray);
        }

        function toggleBoundaryVisibility() {
            const showSigungu = document.getElementById('showSigunguBoundary').checked;
            const showEubmyeondong = document.getElementById('showEubmyeondongBoundary').checked;
            
            map.setLayoutProperty('sigungu-boundaries', 'visibility', showSigungu ? 'visible' : 'none');
            map.setLayoutProperty('eubmyeondong-boundaries', 'visibility', showEubmyeondong ? 'visible' : 'none');
        }

        function addSelection(type) {
            const input = document.getElementById(`${type}Input`);
            const color = document.getElementById(`${type}Color`).value;
            const name = input.value.trim();
            
            if (!name) return;
            
            // Add to selected map
            adminData[type].selected.set(name, color);
            
            // Update display
            updateSelectedDisplay(type);
            
            // Update map
            updateFillLayer(type);
            
            // Clear input
            input.value = '';
        }

        function removeSelection(type, name) {
            adminData[type].selected.delete(name);
            updateSelectedDisplay(type);
            updateFillLayer(type);
        }

        function updateSelectedDisplay(type) {
            const container = document.getElementById(`${type}Selected`);
            container.innerHTML = '';
            
            adminData[type].selected.forEach((color, name) => {
                const item = document.createElement('div');
                item.className = 'selected-item';
                item.innerHTML = `
                    <span>${name}</span>
                    <input type="color" value="${color}" onchange="updateSelectionColor('${type}', '${name}', this.value)">
                    <button class="remove-btn" onclick="removeSelection('${type}', '${name}')">√ó</button>
                `;
                container.appendChild(item);
            });
        }

        function updateSelectionColor(type, name, color) {
            adminData[type].selected.set(name, color);
            updateFillLayer(type);
        }

        function updateFillLayer(type) {
            const colorMap = {};
            adminData[type].selected.forEach((color, name) => {
                colorMap[name] = color;
            });
            
            map.setPaintProperty(`${type}-fill`, 'fill-color', [
                'case',
                ['has', ['get', adminData[type].field], ['literal', colorMap]],
                ['get', ['get', adminData[type].field], ['literal', colorMap]],
                'rgba(0,0,0,0)'
            ]);
        }

        // Add click handlers for interactive selection
        map.on('click', 'sido-fill', (e) => {
            const name = e.features[0].properties.SIDO_NM;
            if (name && !adminData.sido.selected.has(name)) {
                document.getElementById('sidoInput').value = name;
            }
        });

        map.on('click', 'sigungu-fill', (e) => {
            const name = e.features[0].properties.SIGUNGU_NM;
            if (name && !adminData.sigungu.selected.has(name)) {
                document.getElementById('sigunguInput').value = name;
            }
        });

        map.on('click', 'eubmyeondong-fill', (e) => {
            const name = e.features[0].properties.ADM_NM;
            if (name && !adminData.eubmyeondong.selected.has(name)) {
                document.getElementById('eubmyeondongInput').value = name;
            }
        });

        // Add cursor style for clickable areas
        map.on('mouseenter', 'sido-fill', () => map.getCanvas().style.cursor = 'pointer');
        map.on('mouseleave', 'sido-fill', () => map.getCanvas().style.cursor = '');
        map.on('mouseenter', 'sigungu-fill', () => map.getCanvas().style.cursor = 'pointer');
        map.on('mouseleave', 'sigungu-fill', () => map.getCanvas().style.cursor = '');
        map.on('mouseenter', 'eubmyeondong-fill', () => map.getCanvas().style.cursor = 'pointer');
        map.on('mouseleave', 'eubmyeondong-fill', () => map.getCanvas().style.cursor = '');

        // Close autocomplete suggestions when clicking outside
        document.addEventListener('click', function(e) {
            const autocompleteContainers = document.querySelectorAll('.autocomplete-container');
            autocompleteContainers.forEach(container => {
                if (!container.contains(e.target)) {
                    const suggestionsDiv = container.querySelector('.autocomplete-suggestions');
                    if (suggestionsDiv) {
                        hideSuggestions(suggestionsDiv);
                    }
                }
            });
        });
    </script>
</body>
</html>